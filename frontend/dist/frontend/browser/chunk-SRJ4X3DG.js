import{a as M}from"./chunk-QIJ7EUUU.js";import"./chunk-D44SGYRL.js";import{A as o,D as x,E as f,I as m,L as l,M as e,N as i,R as b,S as _,T as d,V as h,W as n,X as c,Y as p,ca as g,da as v,fa as L,ja as S,ka as C,la as I,ma as E,p as u,q as y,ta as w}from"./chunk-EZFQJ4VP.js";function k(r,a){if(r&1&&(e(0,"div",12),n(1),i()),r&2){let t=d();o(),p(" \u2705 ",t.successMessage," ")}}function R(r,a){if(r&1&&(e(0,"div",13),n(1),i()),r&2){let t=d();o(),p(" ",t.errorMessage," ")}}function A(r,a){r&1&&(e(0,"div",14),n(1,"Loading..."),i())}function F(r,a){r&1&&(e(0,"div",14),n(1," No leave requests yet. "),e(2,"a",15),n(3,"Apply now"),i()())}function O(r,a){if(r&1){let t=b();e(0,"button",27),_("click",function(){u(t);let H=d().$implicit,T=d(2);return y(T.cancelLeave(H._id))}),n(1," Cancel "),i()}}function N(r,a){r&1&&(e(0,"span",28),n(1,"\u2014"),i())}function P(r,a){if(r&1&&(e(0,"tr",21)(1,"td",22),n(2),i(),e(3,"td",23),n(4),g(5,"date"),i(),e(6,"td",23),n(7),g(8,"date"),i(),e(9,"td",24)(10,"span"),n(11),i()(),e(12,"td",23),n(13),i(),e(14,"td",24),m(15,O,2,0,"button",25)(16,N,2,0,"span",26),i()()),r&2){let t=a.$implicit,s=d(2);o(2),c(t.reason),o(2),c(v(5,9,t.startDate,"mediumDate")),o(3),c(v(8,12,t.endDate,"mediumDate")),o(3),h("px-2.5 py-1 rounded-full text-xs font-semibold "+s.getStatusClass(t.status)),o(),p(" ",t.status," "),o(2),c(t.adminRemarks||"\u2014"),o(2),l("ngIf",t.status==="Pending"),o(),l("ngIf",t.status!=="Pending")}}function j(r,a){if(r&1&&(e(0,"table",16)(1,"thead",17)(2,"tr")(3,"th",18),n(4,"Reason"),i(),e(5,"th",18),n(6,"Start Date"),i(),e(7,"th",18),n(8,"End Date"),i(),e(9,"th",18),n(10,"Status"),i(),e(11,"th",18),n(12,"Remarks"),i(),e(13,"th",18),n(14,"Action"),i()()(),e(15,"tbody",19),m(16,P,17,15,"tr",20),i()()),r&2){let t=d();o(16),l("ngForOf",t.leaves)}}var D=class r{constructor(a,t){this.leaveService=a;this.cdr=t}leaves=[];isLoading=!0;successMessage="";errorMessage="";ngOnInit(){this.loadLeaves()}loadLeaves(){this.isLoading=!0,this.leaveService.getMyLeaves().subscribe({next:a=>{this.leaves=a,this.isLoading=!1,this.cdr.detectChanges()},error:()=>{this.isLoading=!1,this.cdr.detectChanges()}})}cancelLeave(a){confirm("Are you sure you want to cancel this leave?")&&this.leaveService.cancelLeave(a).subscribe({next:()=>{this.successMessage="Leave cancelled successfully!",this.loadLeaves(),this.cdr.detectChanges(),setTimeout(()=>{this.successMessage=""},3e3)},error:t=>{this.errorMessage=t.error?.message||"Failed to cancel leave.",setTimeout(()=>{this.errorMessage=""},3e3)}})}getStatusClass(a){return{Pending:"bg-yellow-100 text-yellow-700",Approved:"bg-green-100 text-green-700",Rejected:"bg-red-100 text-red-700",Cancelled:"bg-gray-100 text-gray-600"}[a]||""}static \u0275fac=function(t){return new(t||r)(x(M),x(L))};static \u0275cmp=f({type:r,selectors:[["app-leave-history"]],decls:18,vars:5,consts:[[1,"min-h-screen","bg-gray-50","p-6"],[1,"max-w-6xl","mx-auto"],[1,"mb-6","flex","items-center","justify-between"],["routerLink","/employee/dashboard",1,"text-sm","text-blue-600","hover:underline"],[1,"text-2xl","font-bold","text-gray-800","mt-2"],[1,"text-gray-500","text-sm"],["routerLink","/employee/apply",1,"bg-blue-600","hover:bg-blue-700","text-white","text-sm","font-semibold","px-5","py-2.5","rounded-lg","transition"],["class","bg-green-50 text-green-700 text-sm px-4 py-3 rounded-lg mb-4 border border-green-200",4,"ngIf"],["class","bg-red-50 text-red-600 text-sm px-4 py-3 rounded-lg mb-4 border border-red-200",4,"ngIf"],[1,"bg-white","rounded-xl","shadow-sm","overflow-hidden"],["class","text-center py-10 text-gray-400",4,"ngIf"],["class","w-full text-sm",4,"ngIf"],[1,"bg-green-50","text-green-700","text-sm","px-4","py-3","rounded-lg","mb-4","border","border-green-200"],[1,"bg-red-50","text-red-600","text-sm","px-4","py-3","rounded-lg","mb-4","border","border-red-200"],[1,"text-center","py-10","text-gray-400"],["routerLink","/employee/apply",1,"text-blue-500","hover:underline","ml-1"],[1,"w-full","text-sm"],[1,"bg-gray-50","text-gray-500","uppercase","text-xs"],[1,"px-6","py-3","text-left"],[1,"divide-y","divide-gray-100"],["class","hover:bg-gray-50 transition",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50","transition"],[1,"px-6","py-4","text-gray-700"],[1,"px-6","py-4","text-gray-500"],[1,"px-6","py-4"],["class","text-red-500 hover:text-red-700 text-xs font-semibold border border-red-300 px-3 py-1 rounded-lg hover:bg-red-50 transition",3,"click",4,"ngIf"],["class","text-gray-300 text-xs",4,"ngIf"],[1,"text-red-500","hover:text-red-700","text-xs","font-semibold","border","border-red-300","px-3","py-1","rounded-lg","hover:bg-red-50","transition",3,"click"],[1,"text-gray-300","text-xs"]],template:function(t,s){t&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"a",3),n(5,"\u2190 Back to Dashboard"),i(),e(6,"h1",4),n(7,"My Leave History"),i(),e(8,"p",5),n(9,"All your leave requests in one place"),i()(),e(10,"a",6),n(11," + Apply Leave "),i()(),m(12,k,2,1,"div",7)(13,R,2,1,"div",8),e(14,"div",9),m(15,A,2,0,"div",10)(16,F,4,0,"div",10)(17,j,17,1,"table",11),i()()()),t&2&&(o(12),l("ngIf",s.successMessage),o(),l("ngIf",s.errorMessage),o(2),l("ngIf",s.isLoading),o(),l("ngIf",!s.isLoading&&s.leaves.length===0),o(),l("ngIf",!s.isLoading&&s.leaves.length>0))},dependencies:[E,S,C,w,I],encapsulation:2})};export{D as LeaveHistoryComponent};
