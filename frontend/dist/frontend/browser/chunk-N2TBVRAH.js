import{a as D,c as A,e as V,m as j}from"./chunk-FRNUN4OL.js";import{a as O}from"./chunk-QIJ7EUUU.js";import"./chunk-D44SGYRL.js";import{$ as E,A as r,D as _,E as S,I as g,L as m,M as t,N as i,R as b,S as f,T as o,V as y,W as a,X as p,Y as x,Z as L,_ as M,ca as h,da as C,fa as I,ja as w,ka as k,la as F,ma as R,p as v,q as u,ta as T}from"./chunk-EZFQJ4VP.js";function P(n,s){if(n&1&&(t(0,"div",13),a(1),i()),n&2){let e=o();r(),x(" \u2705 ",e.successMessage," ")}}function $(n,s){if(n&1&&(t(0,"div",14),a(1),i()),n&2){let e=o();r(),x(" ",e.errorMessage," ")}}function B(n,s){if(n&1){let e=b();t(0,"button",15),f("click",function(){let d=v(e).$implicit,c=o();return c.selectedFilter=d,u(c.applyFilter())}),a(1),i()}if(n&2){let e=s.$implicit,l=o();y("px-4 py-2 rounded-lg text-sm font-medium transition "+(l.selectedFilter===e?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-100 border")),r(),x(" ",e," ")}}function q(n,s){n&1&&(t(0,"div",16),a(1,"Loading..."),i())}function W(n,s){if(n&1&&(t(0,"div",16),a(1),i()),n&2){let e=o();r(),x(" No ",e.selectedFilter==="All"?"":e.selectedFilter," leave requests found. ")}}function z(n,s){if(n&1){let e=b();t(0,"div",30)(1,"input",31),E("ngModelChange",function(d){v(e);let c=o().$implicit;return M(c.adminRemarks,d)||(c.adminRemarks=d),u(d)}),i(),t(2,"div",32)(3,"button",33),f("click",function(){v(e);let d=o().$implicit,c=o(2);return u(c.updateStatus(d._id,"Approved",d.adminRemarks))}),a(4," Approve "),i(),t(5,"button",34),f("click",function(){v(e);let d=o().$implicit,c=o(2);return u(c.updateStatus(d._id,"Rejected",d.adminRemarks))}),a(6," Reject "),i()()()}if(n&2){let e=o().$implicit;r(),L("ngModel",e.adminRemarks)}}function G(n,s){n&1&&(t(0,"span",35),a(1,"\u2014"),i())}function H(n,s){if(n&1&&(t(0,"tr",22)(1,"td",23)(2,"p",24),a(3),i(),t(4,"p",25),a(5),i()(),t(6,"td",26),a(7),i(),t(8,"td",27),a(9),h(10,"date"),i(),t(11,"td",27),a(12),h(13,"date"),i(),t(14,"td",23)(15,"span"),a(16),i()(),t(17,"td",27),a(18),i(),t(19,"td",23),g(20,z,7,1,"div",28)(21,G,2,0,"span",29),i()()),n&2){let e=s.$implicit,l=o(2);r(3),p(e.employee.name),r(2),p(e.employee.email),r(2),p(e.reason),r(2),p(C(10,11,e.startDate,"mediumDate")),r(3),p(C(13,14,e.endDate,"mediumDate")),r(3),y("px-2.5 py-1 rounded-full text-xs font-semibold "+l.getStatusClass(e.status)),r(),x(" ",e.status," "),r(2),p(e.adminRemarks||"\u2014"),r(2),m("ngIf",e.status==="Pending"),r(),m("ngIf",e.status!=="Pending")}}function J(n,s){if(n&1&&(t(0,"table",17)(1,"thead",18)(2,"tr")(3,"th",19),a(4,"Employee"),i(),t(5,"th",19),a(6,"Reason"),i(),t(7,"th",19),a(8,"Start Date"),i(),t(9,"th",19),a(10,"End Date"),i(),t(11,"th",19),a(12,"Status"),i(),t(13,"th",19),a(14,"Remarks"),i(),t(15,"th",19),a(16,"Actions"),i()()(),t(17,"tbody",20),g(18,H,22,17,"tr",21),i()()),n&2){let e=o();r(18),m("ngForOf",e.filteredLeaves)}}var N=class n{constructor(s,e){this.leaveService=s;this.cdr=e}leaves=[];filteredLeaves=[];isLoading=!0;successMessage="";errorMessage="";selectedFilter="All";adminRemarks="";filters=["All","Pending","Approved","Rejected","Cancelled"];ngOnInit(){this.loadLeaves()}loadLeaves(){this.isLoading=!0,this.leaveService.getAllLeaves().subscribe({next:s=>{this.leaves=s,this.applyFilter(),this.isLoading=!1,this.cdr.detectChanges()},error:()=>{this.isLoading=!1,this.cdr.detectChanges()}})}applyFilter(){this.filteredLeaves=this.selectedFilter==="All"?this.leaves:this.leaves.filter(s=>s.status===this.selectedFilter),this.cdr.detectChanges()}updateStatus(s,e,l){this.leaveService.updateLeaveStatus(s,e,l).subscribe({next:()=>{this.successMessage=`Leave ${e} successfully!`,this.loadLeaves(),setTimeout(()=>{this.successMessage=""},3e3)},error:d=>{this.errorMessage=d.error?.message||"Failed to update leave status.",setTimeout(()=>{this.errorMessage=""},3e3)}})}getStatusClass(s){return{Pending:"bg-yellow-100 text-yellow-700",Approved:"bg-green-100 text-green-700",Rejected:"bg-red-100 text-red-700",Cancelled:"bg-gray-100 text-gray-600"}[s]||""}static \u0275fac=function(e){return new(e||n)(_(O),_(I))};static \u0275cmp=S({type:n,selectors:[["app-manage-leaves"]],decls:18,vars:6,consts:[[1,"min-h-screen","bg-gray-50","p-6"],[1,"max-w-7xl","mx-auto"],[1,"mb-6","flex","items-center","justify-between"],["routerLink","/admin/dashboard",1,"text-sm","text-blue-600","hover:underline"],[1,"text-2xl","font-bold","text-gray-800","mt-2"],[1,"text-gray-500","text-sm"],["class","bg-green-50 text-green-700 text-sm px-4 py-3 rounded-lg mb-4 border border-green-200",4,"ngIf"],["class","bg-red-50 text-red-600 text-sm px-4 py-3 rounded-lg mb-4 border border-red-200",4,"ngIf"],[1,"flex","gap-2","mb-6","flex-wrap"],[3,"class","click",4,"ngFor","ngForOf"],[1,"bg-white","rounded-xl","shadow-sm","overflow-hidden"],["class","text-center py-10 text-gray-400",4,"ngIf"],["class","w-full text-sm",4,"ngIf"],[1,"bg-green-50","text-green-700","text-sm","px-4","py-3","rounded-lg","mb-4","border","border-green-200"],[1,"bg-red-50","text-red-600","text-sm","px-4","py-3","rounded-lg","mb-4","border","border-red-200"],[3,"click"],[1,"text-center","py-10","text-gray-400"],[1,"w-full","text-sm"],[1,"bg-gray-50","text-gray-500","uppercase","text-xs"],[1,"px-6","py-3","text-left"],[1,"divide-y","divide-gray-100"],["class","hover:bg-gray-50 transition",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50","transition"],[1,"px-6","py-4"],[1,"font-medium","text-gray-700"],[1,"text-xs","text-gray-400"],[1,"px-6","py-4","text-gray-600","max-w-xs"],[1,"px-6","py-4","text-gray-500"],["class","flex flex-col gap-2",4,"ngIf"],["class","text-gray-300 text-xs",4,"ngIf"],[1,"flex","flex-col","gap-2"],["type","text","placeholder","Add remark (optional)",1,"border","border-gray-300","rounded","px-2","py-1","text-xs","focus:outline-none","focus:ring-1","focus:ring-blue-400","w-40",3,"ngModelChange","ngModel"],[1,"flex","gap-2"],[1,"bg-green-500","hover:bg-green-600","text-white","text-xs","font-semibold","px-3","py-1.5","rounded-lg","transition",3,"click"],[1,"bg-red-500","hover:bg-red-600","text-white","text-xs","font-semibold","px-3","py-1.5","rounded-lg","transition",3,"click"],[1,"text-gray-300","text-xs"]],template:function(e,l){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"a",3),a(5,"\u2190 Back to Dashboard"),i(),t(6,"h1",4),a(7,"Manage Leave Requests"),i(),t(8,"p",5),a(9,"Approve or reject employee leave requests"),i()()(),g(10,P,2,1,"div",6)(11,$,2,1,"div",7),t(12,"div",8),g(13,B,2,3,"button",9),i(),t(14,"div",10),g(15,q,2,0,"div",11)(16,W,2,1,"div",11)(17,J,19,1,"table",12),i()()()),e&2&&(r(10),m("ngIf",l.successMessage),r(),m("ngIf",l.errorMessage),r(2),m("ngForOf",l.filters),r(2),m("ngIf",l.isLoading),r(),m("ngIf",!l.isLoading&&l.filteredLeaves.length===0),r(),m("ngIf",!l.isLoading&&l.filteredLeaves.length>0))},dependencies:[R,w,k,T,j,D,A,V,F],encapsulation:2})};export{N as ManageLeavesComponent};
