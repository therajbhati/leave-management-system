import{a as c}from"./chunk-D44SGYRL.js";import{d as o,h as s,k as l,n,oa as u,sa as a}from"./chunk-EZFQJ4VP.js";var p=class e{constructor(r,t){this.http=r;this.router=t}apiUrl=`${c.apiUrl}/auth`;currentUserSubject=new o(this.getUserFromStorage());currentUser$=this.currentUserSubject.asObservable();getUserFromStorage(){try{let r=localStorage.getItem("currentUser");return r?JSON.parse(r):null}catch{return null}}get currentUser(){return this.currentUserSubject.value}get token(){return this.currentUser?.token||null}get role(){return this.currentUser?.role||null}get isLoggedIn(){return!!this.currentUser}get isAdmin(){return this.currentUser?.role==="Admin"}login(r,t){return this.http.post(`${this.apiUrl}/login`,{email:r,password:t}).pipe(s(i=>{localStorage.setItem("currentUser",JSON.stringify(i)),this.currentUserSubject.next(i)}))}logout(){localStorage.removeItem("currentUser"),this.currentUserSubject.next(null),this.router.navigate(["/login"])}static \u0275fac=function(t){return new(t||e)(n(u),n(a))};static \u0275prov=l({token:e,factory:e.\u0275fac,providedIn:"root"})};export{p as a};
